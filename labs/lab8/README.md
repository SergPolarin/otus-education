## Настройка расширенных функций EIGRP для IPv4

### Топология

![](topology.png)

### Таблица адресации

|Устройство	|Интерфейс   |IP-адрес	     |Маска подсети  |Шлюз по-умоланию |
|:----------|:-----------|:--------------|:--------------|:----------------|
| R1        |G0/0  	     |192.168.1.1    |255.255.255.0  | -               |
|	          |S0/0/0(DCE) |192.168.12.1   |255.255.255.252| -               |
|	          |S0/0/1      |192.168.13.1   |255.255.255.252| -               |
|	          |Lo1         |192.168.11.1   |255.255.255.252| Н/Д             |
|	          |Lo5         |192.168.11.5   |255.255.255.252| -               |
|	          |Lo9         |192.168.11.9   |255.255.255.252| -               |
|	          |Lo13        |192.168.11.13  |255.255.255.252| -               |
| R2        |G0/0  	     |192.168.2.1    |255.255.255.0  | -               |
|           |S0/0/0      |192.168.12.2   |255.255.255.252| -               |
|  	        |S0/0/1 (DCE)|192.168.23.1   |255.255.255.252| -               |
|	          |Lo1         |192.168.22.1   |255.255.255.252| -               |
| R3        |G0/0    	   |192.168.3.1    |255.255.255.0  | -               |
|	          |S0/0/0(DCE) |192.168.13.2   |255.255.255.252| -               |
|	          |S0/0/1      |192.168.23.2   |255.255.255.252| -               |
|	          |Lo1         |192.168.33.1   |255.255.255.252| Н/Д             |
|	          |Lo5         |192.168.33.5   |255.255.255.252| -               |
|	          |Lo9         |192.168.33.9   |255.255.255.252| -               |
|	          |Lo13        |192.168.33.13  |255.255.255.252| -               |
|	PC-A      |NIC         |192.168.1.3    |255.255.255.0  |192.168.1.1      |
|	PC-B      |NIC         |192.168.2.3    |255.255.255.0  |192.168.2.1      |
|	PC-C      |NIC         |192.168.3.3    |255.255.255.0  |192.168.3.1      |


### Задачи

 1. Создание сети и настройка основных параметров устройства
 2. Настройка EIGRP и проверка подключения
 3. Настройка EIGRP для автоматического объединения
 4. Настройка и распространение статического маршрута по умолчанию
 5. Выполнение точной настройки EIGRP
 
    •	Настройте параметры использования пропускной способности для EIGRP.
    
    •	Настройте интервал отправки пакетов приветствия (hello) и таймер удержания для EIGRP.

#### Часть 1:	Создание сети и настройка основных параметров устройства

#### Часть 2:	Настройка EIGRP и проверка подключения

##### Шаг 1:	Настройте EIGRP.

a.	На маршрутизаторе R1 настройте маршрутизацию EIGRP с номером автономной системы (AS) 1 для всех сетей с прямым подключением. Запишите использованные команды в поле ниже.

Команды

    conf t
    router eigrp 1
    network 192.168.1.0 0.0.0.255
    network 192.168.12.0 0.0.0.3
    network 192.168.13.0 0.0.0.3
    end
    
b.	Для интерфейса локальной сети маршрутизатора R1 отключите передачу пакетов приветствия (hello) EIGRP. Ниже напишите команду, которую вы использовали.

Команда
  
   passive-interface gi0/0
   
c.	На маршрутизаторе R1 настройте пропускную способность для интерфейса S0/0/0 равной 1024 Кбит/с, а для интерфейса S0/0/1 равной 64 Кбит/с. Запишите использованные команды в поле ниже. Примечание. Команда bandwidth влияет только на вычисление показателя EIGRP, а не на фактическую пропускную способность последовательного канала связи.

Команды

    int s0/0/0
    bandwidth 1024
    int s0/0/1
    bandwidth 64
    
##### Шаг 2:	Проверьте связь.

Эхо-запросы с ПК успешно проходят до всех ПК, а так же до всех интерфейсов маршрутизаторов

#### Часть 3:	Настройка EIGRP для автоматического объединения

##### Шаг 1:	Настройте EIGRP для автоматического объединения.

a.	Введите команду show ip protocols на R1. Как по умолчанию настроено автоматическое объединение в EIGRP? 

    Automatic Summarization: disabled
    
b.	Настройте loopback-адреса на R1.

Команды

    interface loopback 1
    ip address 192.168.11.1 255.255.255.252
    ...
    
c.	Добавьте соответствующие инструкции network для процесса EIGRP на маршрутизаторе R1. Запишите использованные команды в поле ниже.

    router eigrp 1
    network 192.168.11.0 0.0.0.3
    network 192.168.11.4 0.0.0.3
    network 192.168.11.8 0.0.0.3
    network 192.168.11.12 0.0.0.3
    
d.	На маршрутизаторе R2 выполните команду show ip route eigrp. Как сети loopback представлены в результатах этой команды?

Вывод

    R2#sh ip route eigrp 
    D    192.168.1.0/24 [90/3014400] via 192.168.12.1, 00:17:18, Serial0/0/0
         192.168.2.0/24 is variably subnetted, 2 subnets, 2 masks
    D    192.168.3.0/24 [90/2172416] via 192.168.23.2, 00:13:38, Serial0/0/1
         192.168.11.0/30 is subnetted, 4 subnets
    D       192.168.11.0 [90/3139840] via 192.168.12.1, 00:05:14, Serial0/0/0
    D       192.168.11.4 [90/3139840] via 192.168.12.1, 00:04:38, Serial0/0/0
    D       192.168.11.8 [90/3139840] via 192.168.12.1, 00:04:32, Serial0/0/0
    D       192.168.11.12 [90/3139840] via 192.168.12.1, 00:04:25, Serial0/0/0
         192.168.13.0/30 is subnetted, 1 subnets
    D       192.168.13.0 [90/41024000] via 192.168.12.1, 00:17:18, Serial0/0/0
                         [90/41024000] via 192.168.23.2, 00:13:38, Serial0/0/1
      
e.	На маршрутизаторе R1 выполните команду auto-summary в рамках процесса EIGRP.
Как изменилась таблица маршрутизации на R2? Таблица маршрутизации сократилась, сеть 192.168.11.0 имеет префикс классовой сети С
      
    R2#sh ip route eigrp 
    D    192.168.1.0/24 [90/3014400] via 192.168.12.1, 00:00:29, Serial0/0/0
         192.168.2.0/24 is variably subnetted, 2 subnets, 2 masks
    D    192.168.3.0/24 [90/2172416] via 192.168.23.2, 00:15:22, Serial0/0/1
    D    192.168.11.0/24 [90/3139840] via 192.168.12.1, 00:00:29, Serial0/0/0
         192.168.12.0/24 is variably subnetted, 3 subnets, 3 masks
    D       192.168.12.0/24 [90/41536000] via 192.168.23.2, 00:00:29, Serial0/0/1
         192.168.13.0/24 is variably subnetted, 2 subnets, 2 masks
    D       192.168.13.0/24 [90/41024000] via 192.168.12.1, 00:00:29, Serial0/0/0
    D       192.168.13.0/30 [90/41024000] via 192.168.23.2, 00:15:22, Serial0/0/1
    
#### Часть 4:	Настройка и распространение статического маршрута по умолчанию

Вывод после настройки

     R2#sh ip protocols 
     Routing Protocol is "eigrp  1 " 
       Outgoing update filter list for all interfaces is not set 
       Incoming update filter list for all interfaces is not set 
       Default networks flagged in outgoing updates  
       Default networks accepted from incoming updates 
       Redistributing: eigrp 1, static                           ???? непонятно почему в распределение попадает EIGRP 1
       EIGRP-IPv4 Protocol for AS(1)
         Metric weight K1=1, K2=0, K3=1, K4=0, K5=0
         NSF-aware route hold timer is 240
         Router-ID: 192.168.2.1
         Topology : 0 (base)
           Active Timer: 3 min
           Distance: internal 90 external 170
           Maximum path: 4
           Maximum hopcount 100
           Maximum metric variance 1
       Automatic Summarization: disabled
       Automatic address summarization: 
       Maximum path: 4
       Routing for Networks:  
          192.168.2.0
          192.168.12.0/30
          192.168.23.0/30
       Passive Interface(s): 
         GigabitEthernet0/0
       Routing Information Sources:  
         Gateway         Distance      Last Update 
         192.168.12.1    90            13285958   
         192.168.23.2    90            13505551   
       Distance: internal 90 external 170
       
e.	На маршрутизаторе R1 выполните команду show ip route eigrp | include 0.0.0.0, чтобы просмотреть инструкции, относящиеся к маршруту по умолчанию. Как статический маршрут по умолчанию представлен в результатах этой команды? Укажите административную дистанцию (AD) распространяемого маршрута. Административная дистанция равна 170.

Вывод 

      R1#sh ip route | i 0.0.0.0
      Gateway of last resort is 192.168.12.2 to network 0.0.0.0
      D*EX 0.0.0.0/0 [170/4291840] via 192.168.12.2, 00:03:00, Serial0/0/0
      
#### Часть 5:	Подгонка EIGRP

##### Шаг 1:	Настройте параметры использования пропускной способности для EIGRP.

При настройке пропускной способности на интерфейсе в CPT не оказалось доступной команды

#### Шаг 2:	Настройте интервал отправки пакетов приветствия (hello) и таймер удержания для EIGRP.

a.	На маршрутизаторе R2 используйте команду show ip eigrp interfaces detail для просмотра интервала приветствия и таймера задержки для EIGRP.

При настройке пропускной способности на интерфейсе в CPT не оказалось доступной команды

b.	Для интерфейсов S0/0/0 и S0/0/1 маршрутизатора R1 настройте интервал приветствия равным 60 секунд, а таймер удержания равным 180 секунд, именно в этом порядке.

При настройке пропускной способности на интерфейсе в CPT не оказалось доступной команды ip hold-interval

#### Вопросы для повторения

1.	В чем заключаются преимущества объединения маршрутов? Сокращение таблицы маршрутизации

2.	Почему при настройке таймеров EIGRP необходимо настраивать значение времени удержания равным или больше интервала приветствия? По истечению времени удержания маршрутизатор будет считать соседа недоступным, следовательно, чтобы получить очередной пакет приветствия и сохранить отношение смежности необходимо установить время удержания равным или бОльшим интервала приветствия
